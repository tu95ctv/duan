<?xml version="1.0" encoding="UTF-8"?>
<odoo>
   <data>
      <report string="In Biên Bản Bàn Giao" id="action_report_picking_dai_hcm" model="stock.picking" report_type="qweb-pdf" name="tonkho.report_picking_dai_hcm" file="stock.report_picking_operations_dai_hcm" />
      <template id="tonkho.report_picking_dai_hcm">
         <t t-call="report.html_container">
            <t t-foreach="docs" t-as="o">
               <!--      <t t-call="report.external_layout"> -->
               <div class="page" style="font-family: Times New Roman">
                  <!-- style="font-family: Times New Roman" -->
                  <t t-call="tonkho.bien_ban_description" />
                  <t t-if="o.pack_operation_ids">
                     <table class="table table-bordered">
                        <!-- table-condensed -->
                        <t t-set="has_barcode" t-value="any([pack_operation.product_id and pack_operation.product_id.sudo().barcode or pack_operation.package_id for pack_operation in o.pack_operation_ids])" />
                        <t t-set="has_serial_number" t-value="o.pack_operation_ids.filtered('pack_lot_ids')" groups="stock.group_production_lot" />
                        <t t-call="tonkho.thead" />
                        <tbody>
                           <t t-set="pack_operation_ids" t-value="o.pack_operation_ids" />
                           <t groups="base.group_portal" t-set="pack_operation_ids" t-value="o.pack_operation_ids.sudo()" />
                           <t t-foreach="pack_operation_ids" t-as="pack_operation">
                              <t t-if="pack_operation.pack_lot_ids">
                                 <t t-foreach="pack_operation.pack_lot_ids" t-as="pack_lot_id">
                                    <t t-call="tonkho.pack_operation_row">
                                       <t t-set="sn" t-value="pack_lot_id.lot_id.name" />
                                       <t t-set="product_qty" t-value="1" />
                                    </t>
                                 </t>
                              </t>
                              <!--  
                              <t t-if="pack_operation.pack_lot_ids" >
                              	<t t-call="tonkho.pack_operation_row">
                                    <t t-set="sn" t-value="a" />
                                 </t>
                              </t>
                               -->
                              <t t-if="not pack_operation.pack_lot_ids">
                                 <t t-call="tonkho.pack_operation_row">
                                    <t t-set="sn" t-value="23454646464" />
                                    <t t-set="product_qty" t-value="pack_operation.product_qty" />
                                 </t>
                              </t>
                           </t>
                        </tbody>
                     </table>
                  </t>
                  <!--  <t t-if="o.pack_operation_ids" > -->
               </div>
               <!-- <div class="page" style="font-family: Times New Roman"> -->
            </t>
            <!-- <t t-foreach="docs" t-as="o"> -->
         </t>
         <!-- <t t-call="report.html_container"> -->
         <!--  </t> -->
      </template>
      <template id="ben_giao_ben_nhan">
         <div class="row">
            <div class="col-xs-6">
               <p class="text-center">
                  Bên Giao
                  <span t-field="o.location_id" />
               </p>
               <p class="text-center">(Ký, họ tên)</p>
            </div>
            <div class="col-xs-6">
               <p class="text-center">Bên Nhận</p>
               <p class="text-center">(Ký, họ tên)</p>
            </div>
         </div>
      </template>
      <template id="bien_ban_description">
         <div class="row" style="">
            <div class="col-xs-6" style="text-align: center;">
               <p>TRUNG TÂM HẠ TẦNG MẠNG MIỀN NAM</p>
               <p style="margin-top:-5px;">
                  <b>ĐÀI VIỄN THÔNG HCM</b>
               </p>
            </div>
            <div class="col-xs-6" style="text-align: center">
               <p>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</p>
               <p style="margin:-10px">Độc Lập - Tự Do - Hạnh Phúc</p>
            </div>
         </div>
         <h2 style="text-align: center;font-weight:bold; margin:50px 0px 50px 0px;">BIÊN BẢN BÀN GIAO VẬT TƯ</h2>
         <p />
         <p>Căn cứ vào tờ trình số:.......... ngày ............... V/v..............</p>
         <p />
         <!--   <p>Hôm nay ngày .........tháng .........năm.........., tại..........</p> -->
         <p>
            Hôm nay ngày:
            <b t-field="o.min_date" t-field-options="{&quot;format&quot;: &quot;dd/MM/YYYY&quot;}" />
         </p>
         <p>Chúng tôi gồm:</p>
         <p style="text-decoration: underline">Đại diện bên giao</p>
                     <t t-set="member_ids" t-value="o.source_member_ids" />
         
         <t t-call="tonkho.ben_giao_nhan_info">
         </t>
         <t t-if="o.dest_member_ids">
            <p style="text-decoration: underline">Đại diện bên nhận</p>
            <t t-call="tonkho.ben_giao_nhan_info">
               <t t-set="member_ids" t-value="o.dest_member_ids" />
            </t>
         </t>
         <p>Chúng tôi đã tiến hành bàn giao các vật tư bên dưới</p>
         <p>Với mục đích..............</p>
      </template>
      <template id="thead">
         <thead>
            <tr>
               <th>
                  <strong>Tên Vật Tư</strong>
                  <!-- Product -->
               </th>
               <th>
                  <!-- class="text-right" -->
                  <strong>Số Lượng</strong>
               </th>
               <!-- 
               <t t-if="o.picking_type_id.code != 'incoming'">
                  <th>
                     <strong>Source</strong>
                  </th>
               </t>
               <th t-if="has_barcode" class="text-center">
                  <strong>Barcode</strong>
               </th>
                -->
               <th t-if="has_serial_number">
                  <strong>Serial Number</strong>
               </th>
               <!-- 
               <t t-if="o.picking_type_id.code != 'outgoing'">
                  <th>
                     <strong>Destination</strong>
                  </th>
               </t>
                -->
            </tr>
         </thead>
      </template>
      <template id="ben_giao_nhan_info">
         <div class="row">
            <t t-foreach="o.source_member_ids" t-as="member">
               <div class="row">
                  <div class="col-xs-10">
                     <div class="col-xs-4" style="padding-left:40px;">
                        Ông bà:
                        <span t-field="member.name" />
                     </div>
                     <div class="col-xs-4" style="padding-left:40px;">
                        Chức Vụ:
                        <span t-field="member.job_id" />
                     </div>
                     <div class="col-xs-4" style="padding-left:40px;">
                        Đơn Vị:
                        <span t-field="member.department_id.get_department_name_for_report" />
                     </div>
                  </div>
               </div>
            </t>
         </div>
      </template>
      <template id="pack_operation_row">
         <tr>
            <!-- 
                                   <td t-if="has_serial_number">
                                        <table class="table table-condensed" t-if="pack_operation.pack_lot_ids">
                                            <tr t-foreach="pack_operation.pack_lot_ids" t-as="packlot">
                                                <td>
                                                    <span t-field="packlot.lot_id"/>
                                                    <t t-if="not packlot.lot_id">
                                                        <span t-field="packlot.lot_name"/>
                                                    </t>
                                                </td>
                                                <td>
                                                    <span t-field="packlot.qty"/> <t t-if="o.picking_type_id.use_existing_lots and o.state!='done'"> / <span t-field="packlot.qty_todo"/></t>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                     -->
            <td>
               <span t-field="pack_operation.product_id" />
            </td>
            <td>
               <!-- class="text-right" -->
               <span t-esc="product_qty" />
               <span t-field="pack_operation.product_uom_id" groups="product.group_uom" />
            </td>
            <!-- 
            <t t-if="o.picking_type_id.code != 'incoming'">
               <td>
                  <span t-field="pack_operation.location_id" />
                  <span t-if="pack_operation.package_id">:</span>
                  <span t-field="pack_operation.package_id" />
               </td>
            </t>
            <td t-if="has_barcode">
               <span t-if="pack_operation.product_id and pack_operation.product_id.barcode">
                  <img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' % ('Code128', pack_operation.product_id.barcode, 600, 100)" style="width:300px;height:50px" />
               </span>
               <span t-if="pack_operation.package_id and not pack_operation.product_id">
                  <img t-att-src="'/report/barcode/?type=%s&amp;value=%s&amp;width=%s&amp;height=%s' % ('Code128', pack_operation.package_id.name, 600, 100)" style="width:300px;height:50px" />
               </span>
            </td>
             -->
            <td t-if="has_serial_number">
               <t t-esc="sn" />
            </td>
            <!-- 
            <t t-if="o.picking_type_id.code != 'outgoing'">
               <td>
                  <span t-field="pack_operation.location_dest_id" />
                  <span t-if="pack_operation.result_package_id">:</span>
                  <span t-field="pack_operation.result_package_id" />
               </td>
            </t>
             -->
         </tr>
      </template>
   </data>
</odoo>